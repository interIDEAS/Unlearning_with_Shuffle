This repository includes the experimental setup, code, and results for the rebuttal of our paper \#13751, "**Efficient Feature Unlearning Using Shuffling: Algorithm and Theoretical Analysis.**". It offers additional details addressing three key aspects raised by the reviewers:

## Figure 1: Results of Advanced Model Architectures with the Most and Least Important Features for Unlearning
### CREDIT Dataset
| <img src="imgs_important_feature/TRI_mlp_CREDIT.png" alt="TRI MLP Results" width="500px"> | <img src="imgs_important_feature/TRI_ftformer_CREDIT.png" alt="TRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/TRI_resnet_CREDIT.png" alt="TRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>TRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>TRI FtFormer Results for Top Two Important(identified by Shapley values) Features</em>                 |                 <em>TRI ResNet Results for Top Two Important(identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/EI_mlp_CREDIT.png" alt="EI MLP Results" width="500px"> | <img src="imgs_important_feature/EI_ftformer_CREDIT.png" alt="EI FtFormer Results" width="500px"> | <img src="imgs_important_feature/EI_resnet_CREDIT.png" alt="EI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>EI MLP Results for Top Two Important (identified by Shapley values) Features</em>                    |                 <em>EI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                  <em>EI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/RASI_mlp_CREDIT.png" alt="RASI MLP Results" width="500px"> | <img src="imgs_important_feature//RASI_ftformer_CREDIT.png" alt="RASI FtFormer Results" width="500px"> | <img src="imgs_important_feature/RASI_resnet_CREDIT.png" alt="RASI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                  <em>RASI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>RASI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                |                 <em>RASI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                 |

| <img src="imgs_important_feature/SDI_mlp_CREDIT.png" alt="SDI MLP Results" width="500px"> | <img src="imgs_important_feature/SDI_ftformer_CREDIT.png" alt="SDI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SDI_resnet_CREDIT.png" alt="SDI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SDI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SDI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SDI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/TRI_mlp_CALI.png" alt="SRI MLP Results" width="500px"> | <img src="imgs_important_feature/SRI_ftformer_CALI.png" alt="SRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SRI_resnet_CALI.png" alt="SRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SRI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SRI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

### CALI Dataset
| <img src="imgs_important_feature/TRI_mlp_CALI.png" alt="TRI MLP Results" width="500px"> | <img src="imgs_important_feature/TRI_ftformer_CALI.png" alt="TRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/TRI_resnet_CALI.png" alt="TRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>TRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>TRI FtFormer Results for Top Two Important(identified by Shapley values) Features</em>                 |                 <em>TRI ResNet Results for Top Two Important(identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/EI_mlp_CALI.png" alt="EI MLP Results" width="500px"> | <img src="imgs_important_feature/EI_ftformer_CALI.png" alt="EI FtFormer Results" width="500px"> | <img src="imgs_important_feature/EI_resnet_CALI.png" alt="EI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>EI MLP Results for Top Two Important (identified by Shapley values) Features</em>                    |                 <em>EI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                  <em>EI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/RASI_mlp_CALI.png" alt="RASI MLP Results" width="500px"> | <img src="imgs_important_feature/RASI_ftformer_CALI.png" alt="RASI FtFormer Results" width="500px"> | <img src="imgs_important_feature/RASI_resnet_CALI.png" alt="RASI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                  <em>RASI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>RASI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                |                 <em>RASI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                 |

| <img src="imgs_important_feature/SDI_mlp_CALI.png" alt="SDI MLP Results" width="500px"> | <img src="imgs_important_feature/SDI_ftformer_CALI.png" alt="SDI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SDI_resnet_CALI.png" alt="SDI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SDI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SDI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SDI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/TRI_mlp_CALI.png" alt="SRI MLP Results" width="500px"> | <img src="imgs_important_feature/SRI_ftformer_CALI.png" alt="SRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SRI_resnet_CALI.png" alt="SRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SRI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SRI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

### MAGIC_TELE Dataset
| <img src="imgs_important_feature/TRI_mlp_MAGIC_TELE.png" alt="TRI MLP Results" width="500px"> | <img src="imgs_important_feature/TRI_ftformer_MAGIC_TELE.png" alt="TRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/TRI_resnet_MAGIC_TELE.png" alt="TRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>TRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>TRI FtFormer Results for Top Two Important(identified by Shapley values) Features</em>                 |                 <em>TRI ResNet Results for Top Two Important(identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/EI_mlp_MAGIC_TELE.png" alt="EI MLP Results" width="500px"> | <img src="imgs_important_feature/EI_ftformer_MAGIC_TELE.png" alt="EI FtFormer Results" width="500px"> | <img src="imgs_important_feature/EI_resnet_MAGIC_TELE.png" alt="EI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>EI MLP Results for Top Two Important (identified by Shapley values) Features</em>                    |                 <em>EI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                  <em>EI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/RASI_mlp_MAGIC_TELE.png" alt="RASI MLP Results" width="500px"> | <img src="imgs_important_feature/RASI_ftformer_MAGIC_TELE.png" alt="RASI FtFormer Results" width="500px"> | <img src="imgs_important_feature/RASI_resnet_MAGIC_TELE.png" alt="RASI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                  <em>RASI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>RASI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                |                 <em>RASI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                 |

| <img src="imgs_important_feature/SDI_mlp_MAGIC_TELE.png" alt="SDI MLP Results" width="500px"> | <img src="imgs_important_feature/SDI_ftformer_MAGIC_TELE.png" alt="SDI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SDI_resnet_MAGIC_TELE.png" alt="SDI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SDI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SDI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SDI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |

| <img src="imgs_important_feature/TRI_mlp_MAGIC_TELE.png" alt="SRI MLP Results" width="500px"> | <img src="imgs_important_feature/SRI_ftformer_MAGIC_TELE.png" alt="SRI FtFormer Results" width="500px"> | <img src="imgs_important_feature/SRI_resnet_MAGIC_TELE.png" alt="SRI ResNet Results" width="500px"> |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|                   <em>SRI MLP Results for Top Two Important (identified by Shapley values) Features</em>                   |                <em>SRI FtFormer Results for Top Two Important (identified by Shapley values) Features</em>                 |                 <em>SRI ResNet Results for Top Two Important (identified by Shapley values) Features</em>                  |



## Figure 2: Advanced Model Architectures with the Highly Correlated  Features for Unlearning

![CALI Latitude Results](imgs/CALI_Latitude.png)
*(a) This graph illustrates the resulted evaluation metrics of unlearning the 'Latitude'(Correlation for``Latitude`` and ``Longitude`` is 0.925) feature using the MLP, ResNet, and FtFormer models.*
![CALI Longitude Results](imgs/CALI_Longtitude.png)
*(b) This graph illustrates the resulted evaluation metrics of unlearning the 'Longtitude' (Correlation for``Latitude`` and ``Longitude`` is 0.925) feature using the MLP, ResNet, and FtFormer models.*
![CALI AveBedrms Results](imgs/CALI_Avgbed.png)
*(c) This graph illustrates the resulted evaluation metrics of unlearning the 'AveBedrms' (Correlation for``AveRooms` and `AveBedrms`is 0.848)  feature using the MLP, ResNet, and FtFormer models.*

![CREDIT NumberOfTimes90DaysLate Results](imgs/CREDIT_90.png)
*(d) This graph illustrates the resulted evaluation metrics of unlearning the 'NumberOfTimes90DaysLate' (Correlation for - `NumberOfTimes90DaysLate` and `NumberOfTime60-89DaysPastDueNotWorse`is 0.991) feature using the MLP, ResNet, and FtFormer models.*
![CREDIT NumberOfTime30-59DaysPastDueNotWorse Results](imgs/CREDIT_3059.png)
*(e): This graph illustrates the resulted evaluation metrics of unlearning the 'NumberOfTime30-59DaysPastDueNotWorse' (Correlation for  `NumberOfTime30-59DaysPastDueNotWorse` and `NumberOfTime60-89DaysPastDueNotWorse` is 0.988) feature using the MLP, ResNet, and FtFormer models.*
![MAGIC_TELE fSize Results](imgs/TETL.png)
*(f) This graph illustrates the resulted evaluation metrics of unlearning the 'fSize'  (Correlation for `fSize`: and `fConc` is 0.847) feature using the MLP, ResNet, and FtFormer models.*




## Figure 3: Implementing Unlearning for Image Classification Tasks using the CelebA Dataset.

![Big_Nose nose Results](imgs/cv/Big_Nose_nose_metrics.png)
*(a) This graph illustrates the resulted evaluation metrics of unlearning the nose feature for Big_Nose classification.*

![Eyeglasses eye Results](imgs/cv/Eyeglasses_eye_metrics.png)
*(b) This graph illustrates the resulted evaluation metrics of unlearning the eye feature for Eyeglasses classification."*

![Male eye Results](imgs/cv/Male_eye_metrics.png)
*(c) This graph illustrates the resulted evaluation metrics of unlearning the eye feature for Gender classification."*

![Male nose Results](imgs/cv/Male_nose_metrics.png)
*(d) This graph illustrates the resulted evaluation metrics of unlearning the nose feature for Gender classification."*

![Male noseeye Results](imgs/cv/Male_noseeye_metrics.png)
*(e) This graph illustrates the resulted evaluation metrics of unlearning ()the nose+eye feature for Gender classification"*

![Narrow_Eyes eye Results](imgs/cv/Narrow_Eyes_eye_metrics.png)
*(f) This graph illustrates the resulted evaluation metrics of unlearning the eye feature for Narrow_Eyes classification."*

![Pointy_Nose nose Results](imgs/cv/Pointy_Nose_nose_metrics.png)
*g This graph illustrates the resulted evaluation metrics of unlearning the nose feature for Pointy_Nose classification"*

### Figure 4: A Graph Demonstration for Unlearning with CelebA Dataset 
![](imgs/example.png)
